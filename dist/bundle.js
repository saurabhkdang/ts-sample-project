(()=>{"use strict";class e{constructor(e,t,n,r){this.templateElement=document.getElementById(e),this.hostElement=document.getElementById(t);const s=document.importNode(this.templateElement.content,!0);this.element=s.firstElementChild,r&&(this.element.id=r),this.attach(n)}attach(e){this.hostElement.insertAdjacentElement(e?"afterbegin":"beforeend",this.element)}}function t(e){let t=!0;return e.required&&(t=t&&0!==e.value.toString().length),null!=e.minLength&&"string"==typeof e.value&&(t=t&&e.value.length>=e.minLength),null!=e.maxLength&&"string"==typeof e.value&&(t=t&&e.value.length<=e.maxLength),null!=e.min&&"number"==typeof e.value&&(t=t&&e.value>=e.min),null!=e.max&&"number"==typeof e.value&&(t=t&&e.value<=e.max),t}function n(e,t,n){const r=n.value;return{configurable:!0,get(){return r.bind(this)}}}var r;!function(e){e[e.Active=0]="Active",e[e.Finished=1]="Finished"}(r||(r={}));class s{constructor(e,t,n,r,s){this.id=e,this.title=t,this.description=n,this.people=r,this.status=s}}class i{constructor(){this.listeners=[]}addListener(e){this.listeners.push(e)}}class l extends i{constructor(){super(),this.projects=[]}static getInstance(){return this.instance||(this.instance=new l),this.instance}addProject(e,t,n){const i=new s(Math.random().toString(),e,t,n,r.Active);this.projects.push(i),this.updateListeners()}moveProject(e,t){const n=this.projects.find((t=>t.id===e));n&&n.status!==t&&(n.status=t,this.updateListeners())}updateListeners(){for(const e of this.listeners)e(this.projects.slice())}}const o=l.getInstance();class a extends e{constructor(){super("project-input","app",!0,"user-input"),this.titleInputElement=this.element.querySelector("#title"),this.descriptionInputElement=this.element.querySelector("#description"),this.peopleInputElement=this.element.querySelector("#people"),this.configure()}configure(){this.element.addEventListener("submit",this.submitHandler)}renderContent(){}gatherUserInput(){const e=this.titleInputElement.value,n=this.descriptionInputElement.value,r=this.peopleInputElement.value,s={value:n,required:!0,minLength:5},i={value:+r,required:!0,min:1,max:5};return t({value:e,required:!0})&&t(s)&&t(i)?[e,n,+r]:void alert("Invalid Input, Please try again!!")}clearInputs(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""}submitHandler(e){e.preventDefault();const t=this.gatherUserInput();if(Array.isArray(t)){const[e,n,r]=t;o.addProject(e,n,r),this.clearInputs()}}}!function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);i>3&&l&&Object.defineProperty(t,n,l)}([n],a.prototype,"submitHandler",null);var c=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class d extends e{get persons(){return 1==this.project.people?"1 person ":`${this.project.people} persons`}constructor(e,t){super("single-project",e,!1,t.id),this.project=t,this.configure(),this.renderContent()}dragStartHandler(e){e.dataTransfer.setData("text/plain",this.project.id),e.dataTransfer.effectAllowed="move"}dragEndHandler(e){console.log("drag ends")}configure(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)}renderContent(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description}}c([n],d.prototype,"dragStartHandler",null),c([n],d.prototype,"dragEndHandler",null);var p=function(e,t,n,r){var s,i=arguments.length,l=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(l=(i<3?s(l):i>3?s(t,n,l):s(t,n))||l);return i>3&&l&&Object.defineProperty(t,n,l),l};class u extends e{constructor(e){super("project-list","app",!1,`${e}-projects`),this.type=e,this.assignedProjects=[],this.configure(),this.renderContent()}dragOverHandler(e){e.dataTransfer&&"text/plain"===e.dataTransfer.types[0]&&(e.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(e){const t=e.dataTransfer.getData("text/plain");o.moveProject(t,"active"==this.type?r.Active:r.Finished)}dragLeaveHandler(e){this.element.querySelector("ul").classList.remove("droppable")}configure(){this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),o.addListener((e=>{const t=e.filter((e=>"active"===this.type?e.status===r.Active:e.status===r.Finished));this.assignedProjects=t,this.renderProjects()}))}renderContent(){const e=`${this.type}-projects-list`;this.element.querySelector("ul").id=e,this.element.querySelector("h2").textContent=this.type.toUpperCase()+" PROJECTS"}renderProjects(){document.getElementById(`${this.type}-projects-list`).innerHTML="";for(const e of this.assignedProjects)new d(this.element.querySelector("ul").id,e)}}p([n],u.prototype,"dragOverHandler",null),p([n],u.prototype,"dropHandler",null),p([n],u.prototype,"dragLeaveHandler",null),new a,new u("active"),new u("finished")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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a0JuRSxFQUFjcUIsT0FBU3JCLEVBQWM0RSxTQUNwRSxDQUdBQyxpQkFBaUI1QixHQUNFbEYsS0FBS1EsUUFBUTJELGNBQWMsTUFDbkNxQyxVQUFVTyxPQUFPLFlBQzVCLENBRUF6QyxZQUVJdEUsS0FBS1EsUUFBUStELGlCQUFpQixXQUFZdkUsS0FBS3NHLGlCQUMvQ3RHLEtBQUtRLFFBQVErRCxpQkFBaUIsWUFBYXZFLEtBQUs4RyxrQkFDaEQ5RyxLQUFLUSxRQUFRK0QsaUJBQWlCLE9BQVF2RSxLQUFLMEcsYUFFM0MzQyxFQUFhdEIsYUFBYUssSUFDdEIsTUFBTWtFLEVBQW1CbEUsRUFBU21FLFFBQU9wRCxHQUNwQixXQUFkN0QsS0FBS29HLEtBQ0R2QyxFQUFJdkIsU0FBV0wsRUFBY3FCLE9BRTdCTyxFQUFJdkIsU0FBV0wsRUFBYzRFLFdBRXhDN0csS0FBS3FHLGlCQUFtQlcsRUFDeEJoSCxLQUFLa0gsZ0JBQWdCLEdBRTdCLENBRUF6QyxnQkFDSSxNQUFNMEMsRUFBUyxHQUFHbkgsS0FBS29HLHFCQUN2QnBHLEtBQUtRLFFBQVEyRCxjQUFjLE1BQU96RCxHQUFLeUcsRUFDdkNuSCxLQUFLUSxRQUFRMkQsY0FBYyxNQUFPK0IsWUFBY2xHLEtBQUtvRyxLQUFLZ0IsY0FBZ0IsV0FDOUUsQ0FFQUYsaUJBQ21CaEgsU0FBU0MsZUFBZSxHQUFHSCxLQUFLb0csc0JBQ3hDaUIsVUFBWSxHQUNuQixJQUFLLE1BQU1DLEtBQVd0SCxLQUFLcUcsaUJBQ3ZCLElBQUlkLEVBQVl2RixLQUFLUSxRQUFRMkQsY0FBYyxNQUFPekQsR0FBSTRHLEVBRTlELEVBckRBLEdBREM3RixHLG9DQVlELEdBRENBLEcsZ0NBUUQsR0FEQ0EsRyxxQ0NuQ1ksSUFBSXdDLEVBQ0MsSUFBSWtDLEVBQVksVUFDZCxJQUFJQSxFQUFZLFciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zYW1wbGUtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50LnRzIiwid2VicGFjazovL3NhbXBsZS1wcm9qZWN0Ly4vc3JjL3V0aWxzL3ZhbGlkYXRpb24udHMiLCJ3ZWJwYWNrOi8vc2FtcGxlLXByb2plY3QvLi9zcmMvZGVjb3JhdG9ycy9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly9zYW1wbGUtcHJvamVjdC8uL3NyYy9tb2RlbHMvcHJvamVjdC50cyIsIndlYnBhY2s6Ly9zYW1wbGUtcHJvamVjdC8uL3NyYy9zdGF0ZS9wcm9qZWN0LXN0YXRlLnRzIiwid2VicGFjazovL3NhbXBsZS1wcm9qZWN0Ly4vc3JjL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dC50cyIsIndlYnBhY2s6Ly9zYW1wbGUtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtaXRlbS50cyIsIndlYnBhY2s6Ly9zYW1wbGUtcHJvamVjdC8uL3NyYy9jb21wb25lbnRzL3Byb2plY3QtbGlzdC50cyIsIndlYnBhY2s6Ly9zYW1wbGUtcHJvamVjdC8uL3NyYy9hcHAudHMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGFic3RyYWN0IGNsYXNzIEJhc2VDbGFzczxUIGV4dGVuZHMgSFRNTEVsZW1lbnQsIFUgZXh0ZW5kcyBIVE1MRWxlbWVudD4ge1xyXG4gICAgdGVtcGxhdGVFbGVtZW50OiBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gICAgaG9zdEVsZW1lbnQ6IFQ7XHJcbiAgICBlbGVtZW50OiBVO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHRlbXBsYXRlSWQ6IHN0cmluZyxcclxuICAgICAgICBob3N0RWxlbWVudElkOiBzdHJpbmcsXHJcbiAgICAgICAgaW5zZXJ0QXRTdGFydDogYm9vbGVhbixcclxuICAgICAgICBuZXdFbGVtZW50SWQ/OiBzdHJpbmdcclxuICAgICl7XHJcbiAgICAgICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZUlkKSEgYXMgSFRNTFRlbXBsYXRlRWxlbWVudDtcclxuICAgICAgICB0aGlzLmhvc3RFbGVtZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaG9zdEVsZW1lbnRJZCkhIGFzIFQ7XHJcblxyXG4gICAgICAgIGNvbnN0IGltcG9ydGVkTm9kZSA9IGRvY3VtZW50LmltcG9ydE5vZGUoXHJcbiAgICAgICAgICAgIHRoaXMudGVtcGxhdGVFbGVtZW50LmNvbnRlbnQsXHJcbiAgICAgICAgICAgIHRydWVcclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGltcG9ydGVkTm9kZS5maXJzdEVsZW1lbnRDaGlsZCBhcyBVO1xyXG4gICAgICAgIGlmKG5ld0VsZW1lbnRJZCkge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQuaWQgPSBuZXdFbGVtZW50SWQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmF0dGFjaChpbnNlcnRBdFN0YXJ0KTtcclxuICAgIH0gIFxyXG4gICAgXHJcbiAgICBwcml2YXRlIGF0dGFjaChpbnNlcnRBdEJlZ2lubmluZzogYm9vbGVhbil7XHJcbiAgICAgICAgdGhpcy5ob3N0RWxlbWVudC5pbnNlcnRBZGphY2VudEVsZW1lbnQoaW5zZXJ0QXRCZWdpbm5pbmc/J2FmdGVyYmVnaW4nOidiZWZvcmVlbmQnLCB0aGlzLmVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIGFic3RyYWN0IGNvbmZpZ3VyZSgpOiB2b2lkO1xyXG4gICAgYWJzdHJhY3QgcmVuZGVyQ29udGVudCgpOiB2b2lkO1xyXG59IiwiLy9WYWxpZGF0aW9uXHJcbmV4cG9ydCBpbnRlcmZhY2UgVmFsaWRhdGFibGUge1xyXG4gICAgdmFsdWU6IHN0cmluZyB8IG51bWJlcjtcclxuICAgIHJlcXVpcmVkPzogYm9vbGVhbjtcclxuICAgIG1pbkxlbmd0aD86IG51bWJlcjtcclxuICAgIG1heExlbmd0aD86IG51bWJlcjtcclxuICAgIG1pbj86IG51bWJlcjtcclxuICAgIG1heD86IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlKHZhbGlkYXRhYmxlSW5wdXQ6IFZhbGlkYXRhYmxlKSB7XHJcbiAgICBsZXQgaXNWYWxpZCA9IHRydWU7XHJcbiAgICBpZih2YWxpZGF0YWJsZUlucHV0LnJlcXVpcmVkKSB7XHJcbiAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS50b1N0cmluZygpLmxlbmd0aCAhPT0gMDtcclxuICAgIH1cclxuXHJcbiAgICBpZih2YWxpZGF0YWJsZUlucHV0Lm1pbkxlbmd0aCAhPSBudWxsICYmIFxyXG4gICAgICAgIHR5cGVvZiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID09PSBcInN0cmluZ1wiKXtcclxuICAgICAgICAgICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGVJbnB1dC52YWx1ZS5sZW5ndGggPj0gdmFsaWRhdGFibGVJbnB1dC5taW5MZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgaWYodmFsaWRhdGFibGVJbnB1dC5tYXhMZW5ndGggIT0gbnVsbCAmJiBcclxuICAgICAgICB0eXBlb2YgdmFsaWRhdGFibGVJbnB1dC52YWx1ZSA9PT0gXCJzdHJpbmdcIil7XHJcbiAgICAgICAgICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUubGVuZ3RoIDw9IHZhbGlkYXRhYmxlSW5wdXQubWF4TGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHZhbGlkYXRhYmxlSW5wdXQubWluICE9IG51bGwgJiYgXHJcbiAgICAgICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09IFwibnVtYmVyXCIpe1xyXG4gICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlID49IHZhbGlkYXRhYmxlSW5wdXQubWluO1xyXG4gICAgfVxyXG5cclxuICAgIGlmKHZhbGlkYXRhYmxlSW5wdXQubWF4ICE9IG51bGwgJiYgXHJcbiAgICAgICAgdHlwZW9mIHZhbGlkYXRhYmxlSW5wdXQudmFsdWUgPT09IFwibnVtYmVyXCIpe1xyXG4gICAgICAgICAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZUlucHV0LnZhbHVlIDw9IHZhbGlkYXRhYmxlSW5wdXQubWF4O1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBpc1ZhbGlkO1xyXG59IiwiZXhwb3J0IGZ1bmN0aW9uIGF1dG9iaW5kKFxyXG4gICAgX3RhcmdldDogYW55LFxyXG4gICAgX21ldGhvZE5hbWU6IHN0cmluZyxcclxuICAgIGRlc2NyaXB0b3I6IFByb3BlcnR5RGVzY3JpcHRvclxyXG4gICAgKXtcclxuICAgICAgICBjb25zdCBvcmlnaW5hbE1ldGhvZCA9IGRlc2NyaXB0b3IudmFsdWU7XHJcbiAgICAgICAgY29uc3QgYWRqRGVzY3JpcHRvcjogUHJvcGVydHlEZXNjcmlwdG9yID0ge1xyXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXHJcbiAgICAgICAgICAgIGdldCgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJvdW5kRm4gPSBvcmlnaW5hbE1ldGhvZC5iaW5kKHRoaXMpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGJvdW5kRm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFkakRlc2NyaXB0b3I7XHJcbn0iLCJleHBvcnQgZW51bSBQcm9qZWN0U3RhdHVzIHtcclxuICAgIEFjdGl2ZSxcclxuICAgIEZpbmlzaGVkXHJcbn1cclxuXHJcbi8vIFByb2plY3QgVHlwZVxyXG5leHBvcnQgY2xhc3MgUHJvamVjdCB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwdWJsaWMgaWQ6IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgZGVzY3JpcHRpb246IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgcGVvcGxlOiBudW1iZXIsXHJcbiAgICAgICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xyXG4gICAgKXtcclxuXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBQcm9qZWN0IH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcbmltcG9ydCB7IFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuXHJcbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcclxuXHJcbmNsYXNzIFN0YXRlPFQ+IHtcclxuICAgIHByb3RlY3RlZCBsaXN0ZW5lcnM6IExpc3RlbmVyPFQ+W10gPSBbXTtcclxuICAgIGFkZExpc3RlbmVyKGxpc3RlbmVyRm46IExpc3RlbmVyPFQ+ICl7XHJcbiAgICAgICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lckZuKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gUHJvamVjdCBTdGF0ZSBNYW5hZ2VtZW50XHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XHJcbiAgICBwcml2YXRlIHByb2plY3RzOiBQcm9qZWN0W10gPSBbXTtcclxuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBQcm9qZWN0U3RhdGU7XHJcblxyXG4gICAgcHJpdmF0ZSBjb25zdHJ1Y3Rvcigpe1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RhdGljIGdldEluc3RhbmNlKCkge1xyXG4gICAgICAgIGlmKHRoaXMuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuaW5zdGFuY2UgPSBuZXcgUHJvamVjdFN0YXRlKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaW5zdGFuY2U7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBub09mUGVvcGxlOiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBuZXdQcm9qZWN0ID0gbmV3IFByb2plY3QoTWF0aC5yYW5kb20oKS50b1N0cmluZygpLCB0aXRsZSwgZGVzY3JpcHRpb24sIG5vT2ZQZW9wbGUsIFByb2plY3RTdGF0dXMuQWN0aXZlKTtcclxuICAgICAgICAvKiBjb25zdCBuZXdQcm9qZWN0ID0ge1xyXG4gICAgICAgICAgICBpZDogTWF0aC5yYW5kb20oKS50b1N0cmluZygpLFxyXG4gICAgICAgICAgICB0aXRsZTogdGl0bGUsXHJcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbixcclxuICAgICAgICAgICAgcGVvcGxlOiBub09mUGVvcGxlXHJcbiAgICAgICAgfSAqL1xyXG5cclxuICAgICAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XHJcbiAgICAgICAgdGhpcy51cGRhdGVMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBtb3ZlUHJvamVjdChwcm9qZWN0SWQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKXtcclxuICAgICAgICBjb25zdCBwcm9qZWN0ID0gdGhpcy5wcm9qZWN0cy5maW5kKHByaiA9PiBwcmouaWQgPT09IHByb2plY3RJZCk7XHJcbiAgICAgICAgaWYocHJvamVjdCAmJiBwcm9qZWN0LnN0YXR1cyAhPT0gbmV3U3RhdHVzKSB7XHJcbiAgICAgICAgICAgIHByb2plY3Quc3RhdHVzID0gbmV3U3RhdHVzO1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUxpc3RlbmVycygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVycygpe1xyXG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXJGbiBvZiB0aGlzLmxpc3RlbmVycykge1xyXG4gICAgICAgICAgICBsaXN0ZW5lckZuKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCk7IiwiaW1wb3J0IHsgQmFzZUNsYXNzIH0gZnJvbSAnLi4vY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudCc7XHJcbmltcG9ydCAqIGFzIFZhbGlkYXRpb24gZnJvbSAnLi4vdXRpbHMvdmFsaWRhdGlvbic7IC8vIGEgd2F5IHRvIGF2b2lkIHRoZSBuYW1lIGNsYXNoZXMgb2YgdGhlIGZ1bmN0aW9ucyBvZiBkaWZmZXJlbnQgaW1wb3J0ZWQgbGlic1xyXG5pbXBvcnQgeyBhdXRvYmluZCBhcyBBdXRvYmluZCB9IGZyb20gJy4uL2RlY29yYXRvcnMvYXV0b2JpbmQnOyAvL2EgYXdheSB0byBhbGlhcyBmb3IgYSBzaW5nbGUgZXhwb3J0XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gJy4uL3N0YXRlL3Byb2plY3Qtc3RhdGUnO1xyXG5cclxuLy8gUHJvamVjdCBDbGFzc1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdElucHV0IGV4dGVuZHMgQmFzZUNsYXNzPEhUTUxEaXZFbGVtZW50LCBIVE1MRm9ybUVsZW1lbnQ+IHtcclxuICAgIHRpdGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBwZW9wbGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAgICAgc3VwZXIoJ3Byb2plY3QtaW5wdXQnLCAnYXBwJywgdHJ1ZSwgJ3VzZXItaW5wdXQnKTtcclxuICAgICAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdGl0bGVcIikgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb25cIikgYXMgSFRNTElucHV0RWxlbWVudDtcclxuICAgICAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI3Blb3BsZVwiKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuICAgICAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbmZpZ3VyZSgpIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKTtcclxuICAgICAgICAvL3RoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCB0aGlzLnN1Ym1pdEhhbmRsZXIuYmluZCh0aGlzKSk7IC8vZGVmYXVsdCB3YXkgdG8gYmluZCBldmVudCBoYW5kbGVyXHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpe31cclxuXHJcbiAgICBwcml2YXRlIGdhdGhlclVzZXJJbnB1dCgpOltzdHJpbmcsIHN0cmluZywgbnVtYmVyXSB8IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGVudGVyZWRUaXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICAgICAgY29uc3QgZW50ZXJlZERlc2NyaXB0aW9uID0gdGhpcy5kZXNjcmlwdGlvbklucHV0RWxlbWVudC52YWx1ZTtcclxuICAgICAgICBjb25zdCBlbnRlcmVkUGVvcGxlID0gdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcblxyXG4gICAgICAgIGNvbnN0IHRpdGxlVmFsaWRhdGFibGU6IFZhbGlkYXRpb24uVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgICAgICAgIHZhbHVlOiBlbnRlcmVkVGl0bGUsXHJcbiAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlOiBWYWxpZGF0aW9uLlZhbGlkYXRhYmxlID0ge1xyXG4gICAgICAgICAgICB2YWx1ZTogZW50ZXJlZERlc2NyaXB0aW9uLFxyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgbWluTGVuZ3RoOiA1XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogVmFsaWRhdGlvbi5WYWxpZGF0YWJsZSA9IHtcclxuICAgICAgICAgICAgdmFsdWU6ICtlbnRlcmVkUGVvcGxlLFxyXG4gICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcclxuICAgICAgICAgICAgbWluOiAxLFxyXG4gICAgICAgICAgICBtYXg6IDVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmKFxyXG4gICAgICAgICAgICAhVmFsaWRhdGlvbi52YWxpZGF0ZSh0aXRsZVZhbGlkYXRhYmxlKSB8fCBcclxuICAgICAgICAgICAgIVZhbGlkYXRpb24udmFsaWRhdGUoZGVzY3JpcHRpb25WYWxpZGF0YWJsZSkgfHwgXHJcbiAgICAgICAgICAgICFWYWxpZGF0aW9uLnZhbGlkYXRlKHBlb3BsZVZhbGlkYXRhYmxlKSlcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGFsZXJ0KFwiSW52YWxpZCBJbnB1dCwgUGxlYXNlIHRyeSBhZ2FpbiEhXCIpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAgIHJldHVybiBbZW50ZXJlZFRpdGxlLCBlbnRlcmVkRGVzY3JpcHRpb24sICtlbnRlcmVkUGVvcGxlXTsgLy9hZGRpbmcgcGx1cyBiZWZvcmUsIHRvIG1ha2UgaXQgYSBudW1iZXJcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjbGVhcklucHV0cygpe1xyXG4gICAgICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgICAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgICAgICAgdGhpcy5wZW9wbGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgIH1cclxuXHJcbiAgICBAQXV0b2JpbmQgLy9EZWNvcmF0b3JcclxuICAgIHByaXZhdGUgc3VibWl0SGFuZGxlcihldmVudDogRXZlbnQpe1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcclxuICAgICAgICBpZihBcnJheS5pc0FycmF5KHVzZXJJbnB1dCkpe1xyXG4gICAgICAgICAgICBjb25zdCBbdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGVdID0gdXNlcklucHV0O1xyXG4gICAgICAgICAgICBwcm9qZWN0U3RhdGUuYWRkUHJvamVjdCh0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZSk7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJJbnB1dHMoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZyh0aGlzLnRpdGxlSW5wdXRFbGVtZW50LnZhbHVlKTtcclxuICAgIH0gXHJcbn0iLCJpbXBvcnQgeyBCYXNlQ2xhc3MgfSBmcm9tICcuLi9jb21wb25lbnRzL2Jhc2UtY29tcG9uZW50JztcclxuaW1wb3J0IHsgRHJhZ2dhYmxlIH0gZnJvbSAnLi4vbW9kZWxzL2RyYWctZHJvcCc7XHJcbmltcG9ydCB7IFByb2plY3QgfSBmcm9tICcuLi9tb2RlbHMvcHJvamVjdCc7XHJcbmltcG9ydCB7IGF1dG9iaW5kIH0gZnJvbSAnLi4vZGVjb3JhdG9ycy9hdXRvYmluZCc7XHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0SXRlbSBleHRlbmRzIEJhc2VDbGFzczxIVE1MVUxpc3RFbGVtZW50LCBIVE1MTElFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdnYWJsZSB7XHJcbiAgICBwcml2YXRlIHByb2plY3Q6IFByb2plY3Q7XHJcblxyXG4gICAgZ2V0IHBlcnNvbnMoKSB7XHJcbiAgICAgICAgaWYodGhpcy5wcm9qZWN0LnBlb3BsZSA9PSAxKXtcclxuICAgICAgICAgICAgcmV0dXJuICcxIHBlcnNvbiAnO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHJldHVybiBgJHt0aGlzLnByb2plY3QucGVvcGxlfSBwZXJzb25zYDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3RydWN0b3IoaG9zdElkOiBzdHJpbmcsIHByb2plY3Q6IFByb2plY3Qpe1xyXG4gICAgICAgIHN1cGVyKCdzaW5nbGUtcHJvamVjdCcsIGhvc3RJZCwgZmFsc2UsIHByb2plY3QuaWQpO1xyXG4gICAgICAgIHRoaXMucHJvamVjdCA9IHByb2plY3Q7XHJcblxyXG4gICAgICAgIHRoaXMuY29uZmlndXJlKCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDb250ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgQGF1dG9iaW5kXHJcbiAgICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpOiB2b2lkIHtcclxuICAgICAgICBldmVudC5kYXRhVHJhbnNmZXIhLnNldERhdGEoJ3RleHQvcGxhaW4nLCB0aGlzLnByb2plY3QuaWQpO1xyXG4gICAgICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJztcclxuICAgIH1cclxuXHJcbiAgICBAYXV0b2JpbmRcclxuICAgIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdkcmFnIGVuZHMnKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25maWd1cmUoKTogdm9pZCB7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcik7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbmQnLCB0aGlzLmRyYWdFbmRIYW5kbGVyKTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcignaDInKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QudGl0bGU7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gzJykhLnRleHRDb250ZW50ID0gdGhpcy5wZXJzb25zICsgJyBhc3NpZ25lZCc7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgeyBCYXNlQ2xhc3MgfSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQgeyBEcmFnVGFyZ2V0IH0gZnJvbSBcIi4uL21vZGVscy9kcmFnLWRyb3BcIjtcclxuaW1wb3J0IHsgUHJvamVjdCB9IGZyb20gXCIuLi9tb2RlbHMvcHJvamVjdFwiO1xyXG5pbXBvcnQgeyBhdXRvYmluZCB9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XHJcbmltcG9ydCB7IHByb2plY3RTdGF0ZSB9IGZyb20gXCIuLi9zdGF0ZS9wcm9qZWN0LXN0YXRlXCI7XHJcbmltcG9ydCB7IFByb2plY3RTdGF0dXMgfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHsgUHJvamVjdEl0ZW0gfSBmcm9tIFwiLi9wcm9qZWN0LWl0ZW1cIjtcclxuXHJcbi8vIFByb2plY3QgTGlzdCBDbGFzc1xyXG5leHBvcnQgY2xhc3MgUHJvamVjdExpc3QgZXh0ZW5kcyBCYXNlQ2xhc3M8SFRNTERpdkVsZW1lbnQsIEhUTUxFbGVtZW50PiBpbXBsZW1lbnRzIERyYWdUYXJnZXQge1xyXG4gICAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdHlwZTogJ2FjdGl2ZScgfCAnZmluaXNoZWQnKSB7XHJcblxyXG4gICAgICAgIHN1cGVyKCdwcm9qZWN0LWxpc3QnLCAnYXBwJywgZmFsc2UsIGAke3R5cGV9LXByb2plY3RzYCk7XHJcbiAgICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XHJcbiAgICAgICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgICAgICB0aGlzLnJlbmRlckNvbnRlbnQoKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgQGF1dG9iaW5kXHJcbiAgICBkcmFnT3ZlckhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG5cclxuICAgICAgICBpZihldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpe1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpOyAvL3RvIGFsbG93IGRyYWcsIGFzIGl0IGRpc2FibGUgYnkgZGVmYXVsdCBpbiBKU1xyXG4gICAgICAgICAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSE7XHJcbiAgICAgICAgICAgIGxpc3RFbC5jbGFzc0xpc3QuYWRkKCdkcm9wcGFibGUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIEBhdXRvYmluZFxyXG4gICAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHByaklkID0gZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XHJcbiAgICAgICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KHByaklkLFxyXG4gICAgICAgICAgICB0aGlzLnR5cGUgPT0gJ2FjdGl2ZSc/IFByb2plY3RTdGF0dXMuQWN0aXZlIDogUHJvamVjdFN0YXR1cy5GaW5pc2hlZClcclxuICAgIH1cclxuXHJcbiAgICBAYXV0b2JpbmRcclxuICAgIGRyYWdMZWF2ZUhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IGxpc3RFbCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpITtcclxuICAgICAgICBsaXN0RWwuY2xhc3NMaXN0LnJlbW92ZSgnZHJvcHBhYmxlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uZmlndXJlKCl7XHJcblxyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIHRoaXMuZHJhZ092ZXJIYW5kbGVyKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2xlYXZlJywgdGhpcy5kcmFnTGVhdmVIYW5kbGVyKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xyXG5cclxuICAgICAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcclxuICAgICAgICAgICAgY29uc3QgcmVsZXZhbnRQcm9qZWN0cyA9IHByb2plY3RzLmZpbHRlcihwcmogPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy50eXBlID09PSAnYWN0aXZlJylcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcmouc3RhdHVzID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZTtcclxuXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJqLnN0YXR1cyA9PT0gUHJvamVjdFN0YXR1cy5GaW5pc2hlZDtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcmVsZXZhbnRQcm9qZWN0cztcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0cygpO1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyQ29udGVudCgpe1xyXG4gICAgICAgIGNvbnN0IGxpc3RJZCA9IGAke3RoaXMudHlwZX0tcHJvamVjdHMtbGlzdGA7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkID0gbGlzdElkO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMudHlwZS50b1VwcGVyQ2FzZSgpICsgJyBQUk9KRUNUUyc7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVyUHJvamVjdHMoKXtcclxuICAgICAgICBjb25zdCBsaXN0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHt0aGlzLnR5cGV9LXByb2plY3RzLWxpc3RgKSEgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgICAgICBsaXN0RWwuaW5uZXJIVE1MID0gJyc7XHJcbiAgICAgICAgZm9yIChjb25zdCBwcmpJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xyXG4gICAgICAgICAgICBuZXcgUHJvamVjdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcmpJdGVtKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgXHJcbn0iLCJpbXBvcnQgeyBQcm9qZWN0SW5wdXQgfSBmcm9tICcuL2NvbXBvbmVudHMvcHJvamVjdC1pbnB1dCc7XHJcbmltcG9ydCB7IFByb2plY3RMaXN0IH0gZnJvbSAnLi9jb21wb25lbnRzL3Byb2plY3QtbGlzdCdcclxuXHJcbmNvbnN0IHByaklucHV0ID0gbmV3IFByb2plY3RJbnB1dCgpO1xyXG5jb25zdCBhY3RpdmVQcmpMaXN0ID0gbmV3IFByb2plY3RMaXN0KCdhY3RpdmUnKTtcclxuY29uc3QgZmluaXNoZWRQcmpMaXN0ID0gbmV3IFByb2plY3RMaXN0KCdmaW5pc2hlZCcpOyJdLCJuYW1lcyI6WyJCYXNlQ2xhc3MiLCJjb25zdHJ1Y3RvciIsInRlbXBsYXRlSWQiLCJob3N0RWxlbWVudElkIiwiaW5zZXJ0QXRTdGFydCIsIm5ld0VsZW1lbnRJZCIsInRoaXMiLCJ0ZW1wbGF0ZUVsZW1lbnQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiaG9zdEVsZW1lbnQiLCJpbXBvcnRlZE5vZGUiLCJpbXBvcnROb2RlIiwiY29udGVudCIsImVsZW1lbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImlkIiwiYXR0YWNoIiwiaW5zZXJ0QXRCZWdpbm5pbmciLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmxlSW5wdXQiLCJpc1ZhbGlkIiwicmVxdWlyZWQiLCJ2YWx1ZSIsInRvU3RyaW5nIiwibGVuZ3RoIiwibWluTGVuZ3RoIiwibWF4TGVuZ3RoIiwibWluIiwibWF4IiwiYXV0b2JpbmQiLCJfdGFyZ2V0IiwiX21ldGhvZE5hbWUiLCJkZXNjcmlwdG9yIiwib3JpZ2luYWxNZXRob2QiLCJjb25maWd1cmFibGUiLCJnZXQiLCJiaW5kIiwiUHJvamVjdFN0YXR1cyIsIlByb2plY3QiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwiU3RhdGUiLCJsaXN0ZW5lcnMiLCJhZGRMaXN0ZW5lciIsImxpc3RlbmVyRm4iLCJwdXNoIiwiUHJvamVjdFN0YXRlIiwic3VwZXIiLCJwcm9qZWN0cyIsInN0YXRpYyIsImluc3RhbmNlIiwiYWRkUHJvamVjdCIsIm5vT2ZQZW9wbGUiLCJuZXdQcm9qZWN0IiwiTWF0aCIsInJhbmRvbSIsIkFjdGl2ZSIsInVwZGF0ZUxpc3RlbmVycyIsIm1vdmVQcm9qZWN0IiwicHJvamVjdElkIiwibmV3U3RhdHVzIiwicHJvamVjdCIsImZpbmQiLCJwcmoiLCJzbGljZSIsInByb2plY3RTdGF0ZSIsImdldEluc3RhbmNlIiwiUHJvamVjdElucHV0IiwidGl0bGVJbnB1dEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQiLCJwZW9wbGVJbnB1dEVsZW1lbnQiLCJjb25maWd1cmUiLCJhZGRFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsInJlbmRlckNvbnRlbnQiLCJnYXRoZXJVc2VySW5wdXQiLCJlbnRlcmVkVGl0bGUiLCJlbnRlcmVkRGVzY3JpcHRpb24iLCJlbnRlcmVkUGVvcGxlIiwiZGVzY3JpcHRpb25WYWxpZGF0YWJsZSIsInBlb3BsZVZhbGlkYXRhYmxlIiwiYWxlcnQiLCJjbGVhcklucHV0cyIsImV2ZW50IiwicHJldmVudERlZmF1bHQiLCJ1c2VySW5wdXQiLCJBcnJheSIsImlzQXJyYXkiLCJQcm9qZWN0SXRlbSIsInBlcnNvbnMiLCJob3N0SWQiLCJkcmFnU3RhcnRIYW5kbGVyIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsImVmZmVjdEFsbG93ZWQiLCJkcmFnRW5kSGFuZGxlciIsIl8iLCJjb25zb2xlIiwibG9nIiwidGV4dENvbnRlbnQiLCJQcm9qZWN0TGlzdCIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwiZHJhZ092ZXJIYW5kbGVyIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJkcm9wSGFuZGxlciIsInByaklkIiwiZ2V0RGF0YSIsIkZpbmlzaGVkIiwiZHJhZ0xlYXZlSGFuZGxlciIsInJlbW92ZSIsInJlbGV2YW50UHJvamVjdHMiLCJmaWx0ZXIiLCJyZW5kZXJQcm9qZWN0cyIsImxpc3RJZCIsInRvVXBwZXJDYXNlIiwiaW5uZXJIVE1MIiwicHJqSXRlbSJdLCJzb3VyY2VSb290IjoiIn0=